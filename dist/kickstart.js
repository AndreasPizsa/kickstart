// Generated by CoffeeScript 1.8.0
(function() {
  var _;

  _ = require('lodash');

  module.exports = function(options) {
    var env, mod, path, pkgname, _i, _len, _ref;
    env = _.extend({
      _: _
    }, options);
    path = require('path');
    if (env.rootDir == null) {
      env.rootDir = path.dirname(require.main.filename);
      env.rootDir = env.rootDir.replace(/\/node_modules\/.*/, '');
    }
    pkgname = path.resolve(env.rootDir, './package.json');
    env.pkginfo = require(pkgname);
    env.use = function(name) {
      return _.extend({}, require(name)(env), env);
    };
    env.uses = env.uses || [];
    if (_.isString(env.uses)) {
      env.uses = env.uses.split(' ');
    }
    if (!_.isArray(env.uses)) {
      env.uses = [env.uses];
    }
    _ref = env.uses;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      mod = _ref[_i];
      env = env.use("kickstart-" + mod);
    }
    return env;
  };

}).call(this);
